<!DOCTYPE html>
<html>
<head>
  <title>Aurora Pulse Quiz</title>
  <style>
    body {
      margin: 0;
      padding: 30px;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      color: #f0f4f8;
      text-align: center;
      overflow-x: hidden;
    }

    h1 {
      font-size: 3em;
      margin-bottom: 20px;
      color: #00ffd5;
      text-shadow: 0 0 15px rgba(0, 255, 213, 0.6);
    }

    select, input[type="number"] {
      padding: 10px;
      font-size: 16px;
      border-radius: 10px;
      border: none;
      margin: 10px;
      background: rgba(255, 255, 255, 0.1);
      color: #00ffd5;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 10px rgba(0,255,213,0.2);
    }

    .question-block {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 30px;
      margin: 30px auto;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
      max-width: 600px;
      transition: transform 0.3s ease;
      display: none;
      backdrop-filter: blur(12px);
    }

    .question-block.active {
      display: block;
    }

    .question-block:hover {
      transform: scale(1.02);
    }

    p {
      font-size: 1.3em;
      margin-bottom: 20px;
      color: #f0f4f8;
    }

    button {
      padding: 10px 20px;
      margin: 10px;
      font-size: 16px;
      background: linear-gradient(to right, #00ffd5, #00bfff);
      color: #0f172a;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
      box-shadow: 0 0 10px rgba(0,255,213,0.3);
    }

    button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(0,255,213,0.5);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    #score {
      font-size: 1.4em;
      margin-top: 20px;
      color: #cbd5e1;
    }

    #progress-container {
      width: 100%;
      background: rgba(255,255,255,0.1);
      border-radius: 10px;
      margin-bottom: 20px;
      backdrop-filter: blur(6px);
    }

    #progress-bar {
      width: 0%;
      height: 20px;
      background: #00ffd5;
      border-radius: 10px;
      transition: width 0.3s ease;
    }

    .timer {
      margin-top: 10px;
      font-size: 1em;
      color: #facc15;
    }

    .feedback {
      margin-top: 10px;
      font-size: 1.1em;
    }
#app-header {
  position: sticky;
  top: 0;
  background: rgba(30, 60, 114, 0.9);
  backdrop-filter: blur(10px);
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 30px;
  font-size: 1.2em;
  color: #00ffd5;
  box-shadow: 0 2px 10px rgba(0,0,0,0.3);
  z-index: 1000;
}

.logo {
  font-weight: bold;
  font-size: 1.5em;
}

    #loader {
      display: none;
      margin: 20px auto;
      border: 6px solid rgba(255,255,255,0.2);
      border-top: 6px solid #00ffd5;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    #history {
      margin-top: 30px;
      font-size: 1em;
      color: #94a3b8;
    }
  </style>
</head>
<body>

<header id="app-header">
  <div class="logo">üß† Aurora Pulse</div>
  <div id="live-score">Score: 0</div>
</header>

  <h1>Aurora Pulse Quiz</h1>

  <select id="topic-select">
    <option value="general">General Knowledge</option>
    <option value="science">Science</option>
    <option value="math">Math</option>
    <option value="history">History</option>
  </select>

  <select id="difficulty-select">
    <option value="easy">Easy</option>
    <option value="medium">Medium</option>
    <option value="hard">Hard</option>
  </select>

  <input type="number" id="timer-input" min="5" max="60" value="10" /> seconds per question

  <div id="progress-container">
    <div id="progress-bar"></div>
  </div>
<div id="review-container" style="display:none;"></div>

  <button onclick="localStorage.removeItem('studentScore'); location.reload();">üîÑ Reset Score</button>
  <div id="score">Score: 0</div>

  <div id="loader"></div>
  <div id="quiz-container"></div>
  <div id="history"></div>

  <script>
    let score = 0;
    let currentQuestion = 0;
    let timerInterval;
    let correctAnswers = {};
    let totalQuestions = 0;
    let questionTime = 10;

    const categoryMap = {
      general: 9,
      science: 17,
      math: 19,
      history: 23
    };

document.getElementById("live-score").textContent = "Score: " + score;
    document.getElementById("topic-select").addEventListener("change", startQuiz);
    document.getElementById("difficulty-select").addEventListener("change", startQuiz);
    document.getElementById("timer-input").addEventListener("change", startQuiz);

    function startQuiz() {
      score = 0;
      currentQuestion = 0;
      document.getElementById("score").textContent = "Score: 0";
      document.getElementById("quiz-container").innerHTML = "";
      document.getElementById("progress-bar").style.width = "0%";
      document.getElementById("loader").style.display = "block";
      questionTime = parseInt(document.getElementById("timer-input").value);
      loadQuestions(
        document.getElementById("topic-select").value,
        document.getElementById("difficulty-select").value
      );
    }

    async function loadQuestions(topic, difficulty) {
      let categoryId = categoryMap[topic] || 9;
      let response = await fetch(`https://opentdb.com/api.php?amount=5&category=${categoryId}&difficulty=${difficulty}&type=multiple`);
      let data = await response.json();

      document.getElementById("loader").style.display = "none";

      if (data.response_code === 0) {
        generateQuiz(data.results);
      } else {
        alert("Failed to load questions. Try a different topic or difficulty.");
      }
    }

    function generateQuiz(questions) {
      const container = document.getElementById("quiz-container");
      totalQuestions = questions.length;
      correctAnswers = {};

      questions.forEach((q, index) => {
        let answers = [...q.incorrect_answers, q.correct_answer];
        answers.sort(() => Math.random() - 0.5);
        correctAnswers[index] = [q.correct_answer];
${index > 0 ? `<button onclick="goToQuestion(${index - 1})">‚¨Ö Previous</button>` : ""}
${index < questions.length - 1 ? `<button onclick="goToQuestion(${index + 1})">Next ‚û°</button>` : ""}

        let block = document.createElement("div");
        block.className = "question-block" + (index === 0 ? " active" : "");
        block.innerHTML = `
          <p>Question ${index + 1}: ${q.question}</p>
          ${answers.map(ans => `<button onclick="checkAnswer(${index}, '${ans.replace(/'/g, "\\'")}', this)"> ${ans} </button>`).join('')}
          <div class="timer">Time left: <span class="time">${questionTime}</span>s</div>
          <div class="feedback"></div>
        `;
        container.appendChild(block);
      });

      startTimer();
    }

    function startTimer() {
      let block = document.querySelectorAll(".question-block")[currentQuestion];
      let timeSpan = block.querySelector(".time");
      let buttons = block.querySelectorAll("button");
      let time = questionTime;

      timerInterval = setInterval(() => {
        time--;
        timeSpan.textContent = time;
        if (time === 0) {
          clearInterval(timerInterval);
          buttons.forEach(btn => btn.disabled = true);
          block.querySelector(".timer").textContent = "‚è∞ Time's up!";
          nextQuestion();
        }
      }, 1000);
    }

    function checkAnswer(QuestionNumber, answer, buttonElement) {
      clearInterval(timerInterval);

      let block = buttonElement.parentElement;
      let feedbackDiv = block.querySelector(".feedback");
      let questionButtons = block.querySelectorAll("button");

      questionButtons.forEach(btn => {
        btn.disabled = true;
        btn.style.cursor = "default";
      });

      if (correctAnswers[QuestionNumber].includes(answer)) {
        buttonElement.style.backgroundColor = "#4ade80";
        score++;
        feedbackDiv.textContent = "‚úÖ Correct!";
        feedbackDiv.style.color = "#4ade80";
      } else {
        buttonElement.style.backgroundColor = "#f87171";
        feedbackDiv.textContent = "‚ùå Incorrect!";
        feedbackDiv.style.color = "#f87171";
      }

      localStorage.setItem("studentScore", score);
      document.getElementById("score").textContent = "Score: " + score;

      let progress = ((currentQuestion + 1) / totalQuestions) * 100;
      document.getElementById("progress-bar").style.width = progress + "%";

      setTimeout(nextQuestion, 1000);
    }

    function nextQuestion() {
      let blocks = document.querySelectorAll(".question-block");
      blocks[currentQuestion].classList.remove("active");
      currentQuestion++;

      if (currentQuestion < blocks.length) {
        blocks[currentQuestion].classList.add("active");
        startTimer();
      } else {
        showReview(blocks);
       
      }
    }
function goToQuestion(index) {
  let blocks = document.querySelectorAll(".question-block");
  blocks[currentQuestion].classList.remove("active");
  currentQuestion = index;
  blocks[currentQuestion].classList.add("active");
  clearInterval(timerInterval);
  startTimer();
}

function showReview(blocks) {
  document.getElementById("quiz-container").style.display = "none";
  document.getElementById("review-container").style.display = "block";

  let html = `<h2 style="color:#00ffd5;">üìù Review Your Answers</h2>`;
  blocks.forEach((block, i) => {
    let question = block.querySelector("p").innerHTML;
    let feedback = block.querySelector(".feedback").innerHTML;
    html += `<div style="margin:20px; padding:20px; background:rgba(255,255,255,0.05); border-radius:12px;">
      <p>${question}</p>
      <p>${feedback}</p>
    </div>`;
  });

  html += `<button onclick="location.reload()">üîÅ Restart Quiz</button>`;
  document.getElementById("review-container").innerHTML = html;
}

    // Load default topic on first load
    window.onload = function () {
      let savedScore = localStorage.getItem("studentScore");
      if (savedScore !== null) {
        score = parseInt(savedScore);
        document.getElementById("score").textContent = "Score: " + score;
      }
      loadQuestions("general");
    };
  </script>
</body>
</html>